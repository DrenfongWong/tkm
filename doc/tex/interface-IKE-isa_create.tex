\subsubsection{isa\_create}
IKE uses this exchange to request derivation of IKE key material for a new IKE SA specified by isa\_id. As a new authenticated endpoint is created, an ae\_id has to be provided too. TKM derives keying material for the IKE SA using the shared secret stored in the DH context and the nonces performing the calculations defined in RFC 5996, sections 2.13 and 2.14. The used DH and nonce contexts are cleared after the key derivation procedure. (As the nonces are still required for isa\_auth and esa\_create\_first, they are stored in the AE context.) nonce\_rem and spi\_rem are values received from the peer, spi\_loc is generated by IKE. The initiator flag designates if IKE is the initiator or responder of the IKE SA. The parameter ia\_id defines the algorithms to use as pseudo-random function, encryption and integrity protection of the IKE SA identified by isa\_id.
\paragraph*{Exchange identifier}
\hex{0901}

\paragraph{Request} ~\\
\begin{exchangeparameters}{isa\_create request parameters}
operation & operation\_type & Exchange ID: \hex{0901} \\

req\_id & req\_id\_type & Request ID, chosen by untrusted \\
isa\_id & isa\_id\_type & Handle of ISA context to create \\
ae\_id & ae\_id\_type & Handle of AE context to create \\
ia\_id & ia\_id\_type & Handle of IKE algorithms \\
dh\_id & dh\_id\_type & Handle of DH context holding shared secret \\
nc\_loc\_id & nc\_id\_type & Handle of local nonce \\
nonce\_rem & nonce\_type & Nonce of peer \\
initiator & init\_type & Flag designating initiator or responder role \\
spi\_loc & ike\_spi\_type & Local IKE security policy identifier \\
spi\_rem & ike\_spi\_type & Remote IKE security policy identifier \\
\end{exchangeparameters}

\paragraph{Response} ~\\
\begin{exchangeparameters}{isa\_create response parameters}

operation & operation\_type & Exchange ID: \hex{0901} \\
req\_id & req\_id\_type & Request ID, returned identically \\
status & status\_type & Error code \\
sk\_ai & key\_type & Integrity protection key of initiator \\
sk\_ar & key\_type & Integrity protection key of responder \\
sk\_ei & key\_type & Encryption key of initiator \\
sk\_er & key\_type & Encryption key of responder \\
\end{exchangeparameters}

